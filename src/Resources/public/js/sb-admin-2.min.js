/*!
 * Start Bootstrap - SB Admin 2 v4.0.4 (https://startbootstrap.com/template-overviews/sb-admin-2)
 * Copyright 2013-2020 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

"use strict";function createFormErrorMessage(e){return'<div class="alert alert-danger alert-dismissible fade show" role="alert">        <i class="fas fa-info-circle"></i>        <span class="small text-muted">'+e+'</span>        <button type="button" class="close" data-dismiss="alert" aria-label="Close">            <span aria-hidden="true">×</span>        </button>    </div>'}function fieldUploadFile(n){$(n).next(".custom-file-label").html(n.files[0].name);var e=new FormData;e.append("file",n.files[0]),e.append("field_alias",$(n).data("field-alias")),$.ajax({url:Routing.generate("teebb_file_upload"),type:"POST",data:e,contentType:!1,processData:!1,dataType:"json"}).done(function(e){$(n).closest("div.custom-file").addClass("d-none"),$(n).attr("disabled","disabled");var t=$(n).closest("fieldset.form-group"),a=t.find(".file-other-info-wrapper");a.find("div.file-show").removeClass("d-none"),a.find("a.file").attr("href",e.url),a.find("a.file").append(e.file.originFileName),a.find("img.file").attr("src",e.hasOwnProperty("thumbnailUrl")?e.thumbnailUrl:e.url),a.find("img.file").attr("alt",e.file.originFileName),a.find("button.btn-file-delete").attr("data-file-id",e.file.id),t.find("input.target-file-id-input").val(e.file.id)}).fail(function(e){$(n).closest("div.file-upload-file-wrapper").prepend(createFormErrorMessage(e.responseJSON.detail))})}function fieldFileDelete(r){var e=new FormData;e.append("id",$(r).data("file-id")),$.ajax({url:Routing.generate("teebb_file_delete"),type:"POST",data:e,contentType:!1,processData:!1,dataType:"json"}).done(function(e){var t=$(r).closest("div.prototype-wrapper"),a=t.data("prototype"),n=$(r).closest("div.file-upload-wrapper").parent("fieldset"),o=n.index(),i=a.replace(/__name__/g,o);t.insertAt(o,i),n.remove()}).fail(function(e){$(r).closest("fieldset").prepend(createFormErrorMessage(e.responseJSON.detail))})}function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?decodeURIComponent(a[2]):null}function replaceUrlParamVal(url,paramName,replaceWith){var re=eval("/("+paramName+"=)([^&]*)/gi");return url.replace(re,paramName+"="+replaceWith)}function setSelectChecked(e,t){for(var a=$(e),n=0;n<a.options.length;n++)if(a.options[n].innerHTML===t){a.options[n].selected=!0;break}}function createMenuInfoInput(e,t){var a=t.id,n="",o="",i="";return"content"===e&&(n=Routing.generate("teebb_content_show",{slug:t.slug}),o=t.title,i="search_content_result_"+t.id),"taxonomy"===e&&(n=Routing.generate("teebb_taxonomy_contents",{slug:t.slug}),o=t.term,i="search_term_result_"+t.id),'<div class="form-check">   <input class="form-check-input mr-2 menu-info-input" type="checkbox"    data-path="'+n+'"    data-label="'+o+'"    value="'+a+'" id="'+i+'">   <label class="form-check-label" for="'+i+'">'+o+"  </label>   </div>"}function ajaxPostMenuInfos(e,t){var a=$("#menu-name-input").data("menu-id"),n=new FormData;n.append("menus",JSON.stringify(e)),$.ajax({url:Routing.generate("teebb_menu_add_items_api",{id:a}),type:"POST",data:n,contentType:!1,processData:!1,dataType:"json"}).done(function(e){window.location.reload()}).fail(function(e){t.prepend(createFormErrorMessage(e.responseJSON.detail))})}$.fn.insertAt=function(e,t){var a=this.children().length;return e<0&&(e=Math.max(0,a+1+e)),this.append(t),e<a&&this.children().eq(e).before(this.children().last()),this},$("#sidebarToggle, #sidebarToggleTop").on("click",function(e){$("body").toggleClass("sidebar-toggled");var t=$(".sidebar");t.toggleClass("toggled"),t.hasClass("toggled")&&$(".sidebar .collapse").collapse("hide")}),$(window).resize(function(){$(window).width()<768&&$(".sidebar .collapse").collapse("hide")}),$("body.fixed-nav .sidebar").on("mousewheel DOMMouseScroll wheel",function(e){var t,a;768<$(window).width()&&(a=(t=e.originalEvent).wheelDelta||-t.detail,this.scrollTop+=30*(a<0?1:-1),e.preventDefault())}),$(document).on("scroll",function(){100<$(this).scrollTop()?$(".scroll-to-top").fadeIn():$(".scroll-to-top").fadeOut()}),$(document).on("click","a.scroll-to-top",function(e){var t=$(this);$("html, body").stop().animate({scrollTop:$(t.attr("href")).offset().top},1e3,"easeInOutExpo"),e.preventDefault()}),$(document).on("click",".card table thead input[type=checkbox].check-all",function(e){var t=$(this).closest("table").find("tbody tr td input[type=checkbox]");$.each(t,function(e,t){$(t).prop("checked",!$(t).prop("checked"))})}),$(document).on("input","input[type=text].transliterate",function(e){var t=$(this).val(),a=$(this).closest("form"),n=slugify(t).replace(/-/gi,"_");a.find("span.text-alias").text(n),a.find("input.input-alias").val(n),a.find("a.js-modify-alias").removeClass("d-none")}),$(document).on("click","a.js-modify-alias",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest("form");t.find("div.text-alias-wrapper").addClass("d-none"),t.find("div.input-alias-wrapper").removeClass("d-none"),t.find("input[type=hidden].input-alias").attr("type","text")}),$(document).on("change","div.select-field-form select",function(e){$(this).closest("div.form-row").closest("div.select-field-form").find("div.field-info").removeClass("d-none")}),$(document).on("change","select#select_field_limit",function(e){var t=$(this).closest("div.select-field-limit"),a=t.find("input[type=number].input-field-limit"),n=t.find("div#select_field_limit_input_wrapper");"0"===$(this).val()&&(a.attr("value","0"),a.addClass("d-none"),n.toggleClass("d-none")),"limit"===$(this).val()&&(a.attr("value","1"),a.removeClass("d-none"),n.toggleClass("d-none"))}),$(document).on("input","input[type=text].input-allow-extension-name",function(e){var t=$(this).val().replace(/[，| |\-|_|\－]/,",");$(this).val(t)}),$(document).on("click","a.js-sortable",function(e){e.preventDefault(),e.stopPropagation()}),$(document).ready(function(){$(".bootstrap-select .bs-searchbox input").addClass("form-control-sm")}),$('.js-add-menu-item a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=$(e.target),a=$(e.relatedTarget);t.addClass("bg-gray-100 border-bottom-gray-100"),a.removeClass("bg-gray-100 border-bottom-gray-100")}),$(".dd-item .accordion-arrow").on("click",function(e){$(e.target).closest(".dd-item").find(".collapse").collapse("toggle")}),$("td.js-comment-td").hover(function(e){$(e.target).find(".comment-option").css("left","0px")},function(e){$(e.target).find(".comment-option").css("left","-9999em")}),$("button#edit_comment_time_btn").on("click",function(e){$(e.target).closest(".comment-time").find("input#comment_time").removeAttr("disabled"),$(e.target).hide()}),$("button.form-field-add-item").on("click",function(e){var t=$(this).parent(".form-group").find("div.prototype-wrapper"),a=t.data("prototype"),n=t.children().length,o=a.replace(/__name__/g,n);t.append(o),console.log(a,n)}),$("a.toggle-show-summary").on("click",function(e){var t=$(this).attr("aria-expanded");console.log(t,"true"===t,"false"===t);var a=$(this).data("show-text"),n=$(this).data("hide-text"),o=$(this).find("span.font-italic");"true"!==t&&!t||o.text(a),"false"!==t&&t||o.text(n)}),$("select.page-limit-select").on("change",function(e){var t,a=$(this).data("path"),n="";n=null!==getQueryString("limit")?replaceUrlParamVal(a,"limit",$(this).val()):(t=-1===a.indexOf("?")?"?":"&",a+t+"limit="+$(this).val()),window.location=n}),$(".prototype-wrapper").on("focus",".js-reference-entity-autocomplete",function(){var a,n,o,e;"1"!=$(this).data("autocomplete")&&(a=$(this).data("autocomplete-url"),n=$(this).data("reference-types"),o=$(this).data("type-label"),e=$(this).data("find-label"),$(this).autocomplete({hint:!1},[{source:function(e,t){$.ajax({method:"POST",url:a,data:{query:e,reference_types:n,type_label:o}}).then(function(e){t(e)})},displayKey:e,debounce:500}]),$(this).data("autocomplete","1"))}),$("#button-search-contents").click(function(e){var t=$("#search-contents-input").val(),a=new FormData;a.append("keyword",t);var n=$(".search-content-result");$.ajax({url:Routing.generate("teebb_content_search_api"),type:"POST",data:a,contentType:!1,processData:!1,dataType:"json"}).done(function(e){var t="";e.forEach(function(e){t+=createMenuInfoInput("content",e)}),n.append(t)}).fail(function(e){n.append(createFormErrorMessage(e.responseJSON.detail))})}),$("#button-search-terms").click(function(e){var t=$("#search-terms-input").val(),a=new FormData;a.append("keyword",t);var n=$(".search-term-result");$.ajax({url:Routing.generate("teebb_taxonomy_search_api"),type:"POST",data:a,contentType:!1,processData:!1,dataType:"json"}).done(function(e){var t="";e.forEach(function(e){t+=createMenuInfoInput("taxonomy",e)}),n.append(t)}).fail(function(e){n.append(createFormErrorMessage(e.responseJSON.detail))})}),$(".add-menu-btn").click(function(e){for(var t=$(this).closest(".card-body"),a=t.find("input.menu-info-input:checked"),n=[],o=0;o<a.length;o++){var i=$(a[o]),r={};r.path=i.data("path"),r.label=i.data("label"),n.push(r)}ajaxPostMenuInfos(n,t)}),$(".add-custom-menu-btn").click(function(e){var t=$(this).closest(".card-body"),a=[],n={};n.path=$("#link_url").val(),n.label=$("#link_title").val(),a.push(n),ajaxPostMenuInfos(a,t)}),$(".remove-menu-item-btn").click(function(e){var t=$(this).closest(".card-body"),a=$("#menu-name-input").data("menu-id"),n=$(this).data("menu-item-id"),o=new FormData;o.append("menu-item-id",n),$.ajax({url:Routing.generate("teebb_menu_remove_item_api",{id:a}),type:"POST",data:o,contentType:!1,processData:!1,dataType:"json"}).done(function(e){window.location.reload()}).fail(function(e){t.prepend(createFormErrorMessage(e.responseJSON.detail))})}),$(".search-form").on("submit",function(e){var t=$(this).children(".search-text-input").val();alert(t)});